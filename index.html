<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farcaster Profile Optimizer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .credit {
            margin-top: 15px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .profile-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #667eea;
        }

        .profile-info h2 {
            color: #333;
            margin-bottom: 5px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#667eea var(--score), #e0e0e0 0);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
        }

        .score-circle::before {
            content: '';
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            position: absolute;
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
        }

        .analysis-section {
            margin-bottom: 25px;
        }

        .analysis-section h3 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-content {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            line-height: 1.6;
        }

        .analysis-content ul {
            list-style: none;
            padding-left: 0;
        }

        .analysis-content li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .analysis-content li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
            font-size: 20px;
        }

        .improved-bio {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #667eea;
        }

        .copy-btn {
            margin-top: 15px;
            width: auto;
            padding: 10px 20px;
            font-size: 14px;
            background: #667eea;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #c33;
            display: none;
        }

        .results {
            display: none;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-stats {
                grid-template-columns: 1fr;
            }
        }

        .username-prefix {
            color: #999;
            font-weight: normal;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Profile Optimizer</h1>
            <p class="subtitle">AI-powered Farcaster profile analysis</p>
            <p class="credit">‚ú® Created by: <strong>paypaleth.eth</strong></p>
        </div>

        <div class="card">
            <div class="input-group">
                <label for="username">Farcaster Username</label>
                <input 
                    type="text" 
                    id="username" 
                    placeholder="Enter username (without @)"
                    autocomplete="off"
                >
            </div>
            <button onclick="analyzeProfile()">Analyze Profile ‚ú®</button>
            <div class="error" id="error"></div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Fetching profile data...</p>
        </div>

        <div class="card results" id="results">
            <div class="profile-header">
                <img src="" alt="Profile" class="profile-image" id="profileImage">
                <div class="profile-info">
                    <h2 id="displayName"></h2>
                    <p id="usernameDiplay"></p>
                </div>
            </div>

            <div class="profile-stats">
                <div class="stat-box">
                    <div class="stat-value" id="followers">0</div>
                    <div class="stat-label">Followers</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="following">0</div>
                    <div class="stat-label">Following</div>
                </div>
                <div class="stat-box">
                    <div class="score-circle" id="scoreCircle" style="--score: 0%">
                        <div class="score-value" id="score">-</div>
                    </div>
                    <div class="stat-label">Profile Score</div>
                </div>
            </div>

            <div class="analysis-section">
                <h3>‚ú® Strengths</h3>
                <div class="analysis-content" id="strengths"></div>
            </div>

            <div class="analysis-section">
                <h3>‚ö†Ô∏è Areas to Improve</h3>
                <div class="analysis-content" id="improvements"></div>
            </div>

            <div class="analysis-section">
                <h3>üí° Suggestions</h3>
                <div class="analysis-content" id="suggestions"></div>
            </div>

            <div class="analysis-section">
                <h3>‚úçÔ∏è Improved Bio</h3>
                <div class="improved-bio" id="improvedBio"></div>
                <button class="copy-btn" onclick="copyBio()">üìã Copy Bio</button>
            </div>
        </div>
    </div>

    <script>
    const NEYNAR_API_KEY = 'NEYNAR_API_DOCS';
    const OPENROUTER_API_KEY = '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';

    document.addEventListener('DOMContentLoaded', function() {
        const input = document.getElementById('username');
        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeProfile();
            }
        });
    });

    async function analyzeProfile() {
        const username = document.getElementById('username').value.trim().replace('@', '');
        const loading = document.getElementById('loading');
        const results = document.getElementById('results');
        const error = document.getElementById('error');

        if (!username) {
            showError('Please enter a username');
            return;
        }

        error.style.display = 'none';
        results.style.display = 'none';
        loading.style.display = 'block';

        try {
            const profileData = await fetchProfileData(username);
            const analysis = await analyzeWithAI(profileData);
            displayResults(profileData, analysis);
        } catch (error) {
            console.error('Error in analyzeProfile:', error);
            showError('Failed to analyze profile. Please try again.');
        } finally {
            loading.style.display = 'none';
        }
    }

    // ‚¨áÔ∏è ŸÅŸÇÿ∑ ÿß€åŸÜ ÿÆÿ∑ ÿ±Ÿà ÿßÿ∂ÿßŸÅŸá ⁄©ÿ±ÿØŸÖ
    window.analyzeProfile = analyzeProfile;

    async function fetchProfileData(username) {
        const response = await fetch(`https://api.neynar.com/v2/farcaster/user/by_username?username=${username}`, {
            headers: {
                'accept': 'application/json',
                'api_key': NEYNAR_API_KEY
            }
        });

        if (!response.ok) {
            throw new Error('Failed to fetch profile');
        }

        const data = await response.json();
        return data.user;
    }

    async function analyzeWithAI(profileData) {
        const prompt = `Analyze this Farcaster profile and provide detailed feedback:

Username: ${profileData.username}
Display Name: ${profileData.display_name || 'Not set'}
Bio: ${profileData.profile.bio.text || 'No bio'}
Followers: ${profileData.follower_count}
Following: ${profileData.following_count}
Verified Addresses: ${profileData.verified_addresses?.eth_addresses?.length || 0}

Please provide:
1. A profile score (0-100)
2. Key strengths (as bullet points)
3. Areas to improve (as bullet points)
4. Specific actionable suggestions (as bullet points)
5. An improved version of their bio (keep it concise and engaging)

Format your response as JSON with these exact keys:
{
    "score": number,
    "strengths": ["strength1", "strength2", ...],
    "improvements": ["improvement1", "improvement2", ...],
    "suggestions": ["suggestion1", "suggestion2", ...],
    "improvedBio": "string"
}`;

        const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${OPENROUTER_API_KEY}`,
                'Content-Type': 'application/json',
                'HTTP-Referer': window.location.href,
                'X-Title': 'Farcaster Profile Optimizer'
            },
            body: JSON.stringify({
                model: 'meta-llama/llama-3.2-3b-instruct:free',
                messages: [
                    {
                        role: 'user',
                        content: prompt
                    }
                ],
                response_format: { type: 'json_object' }
            })
        });

        if (!response.ok) {
            throw new Error('AI analysis failed');
        }

        const data = await response.json();
        return JSON.parse(data.choices[0].message.content);
    }

    function displayResults(profileData, analysis) {
        document.getElementById('profileImage').src = profileData.pfp_url;
        document.getElementById('displayName').textContent = profileData.display_name || profileData.username;
        document.getElementById('usernameDiplay').innerHTML = `<span class="username-prefix">@</span>${profileData.username}`;
        document.getElementById('followers').textContent = profileData.follower_count.toLocaleString();
        document.getElementById('following').textContent = profileData.following_count.toLocaleString();
        
        const score = analysis.score;
        document.getElementById('score').textContent = score;
        document.getElementById('scoreCircle').style.setProperty('--score', `${(score/100) * 360}deg`);

        document.getElementById('strengths').innerHTML = createList(analysis.strengths);
        document.getElementById('improvements').innerHTML = createList(analysis.improvements);
        document.getElementById('suggestions').innerHTML = createList(analysis.suggestions);
        document.getElementById('improvedBio').textContent = analysis.improvedBio;

        document.getElementById('results').style.display = 'block';
    }

    function createList(items) {
        return '<ul>' + items.map(item => `<li>${item}</li>`).join('') + '</ul>';
    }

    function showError(message) {
        const error = document.getElementById('error');
        error.textContent = message;
        error.style.display = 'block';
    }

    function copyBio() {
        const bio = document.getElementById('improvedBio').textContent;
        navigator.clipboard.writeText(bio).then(() => {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úÖ Copied!';
            setTimeout(() => {
                btn.textContent = originalText;
            }, 2000);
        });
    }
    </script>
</body>
</html>
